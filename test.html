<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>Baltimore Surveillance</title>

    <script src="https://api.tiles.mapbox.com/mapbox-gl-js/v3.3.0/mapbox-gl.js"></script>
    <link
      href="https://api.tiles.mapbox.com/mapbox-gl-js/v3.3.0/mapbox-gl.css"
      rel="stylesheet"
    />
    <style>
      body {
        margin: 0;
        padding: 0;
      }

      h2,
      h3 {
        margin: 10px;
        font-size: 20px;
      }

      h3 {
        font-size: 16px;
      }

      p {
        margin: 10px;
      }

      .map-overlay {
        position: absolute;
        bottom: 0;
        background: rgba(95, 113, 180, 0.717);
        width: 300px;
        margin-left: 40px;
        font-family: Georgia, 'Times New Roman', Times, serif;
        overflow: auto;
        border-radius: 3px;
        color: white;
        margin-top: 40px;
      }

      #map {
        position: absolute;
        top: 0;
        bottom: 0;
        width: 100%;
      }

      #features {
        left: 0;
        height: 200px;
        box-shadow: 0 1px 2px rgb(0 0 0 / 10%);
        /* width: 300px; */
        top: 0;
        padding-left: 30px;
        padding-top: 30px;
        
        
      }

      #legend {
        padding: 10px;
        box-shadow: 0 1px 2px rgb(0 0 0 / 10%);
        line-height: 18px;
        height: 100px;
        bottom: 0;
        /* margin-right: 20px; */
        width: 100px;
      }

      .legend-key {
        display: inline-block;
        border-radius: 20%;
        width: 10px;
        height: 10px;
        margin-right: 5px;
      }

      .geocoder {
        position: absolute;
        /* z-index: 1;
        width: 50%;
        /* left: 50%; */
        /* margin-left: 25%;
        top: 10px; */
    
    }
  .mapboxgl-ctrl-geocoder {
        /* min-width: 100%; */
     
    }

  /* Media query for smaller screens */
@media screen and (max-width: 600px) {
    .map-overlay {
        width: 70%;
        max-width: none;
        left: 5%;
        right: 5%;
    }

    #legend {
        top: auto;
        bottom: 10px;
    }
}
    </style>

  </head>
  <body>

    <script src="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-geocoder/v5.0.0/mapbox-gl-geocoder.min.js"></script>
    <link rel="stylesheet" href="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-geocoder/v5.0.0/mapbox-gl-geocoder.css" type="text/css">

    <div id="map"></div>
    <div class="map-overlay" id="features">
        <h2>Check your neighborhood</h2>
        <div id="geocoder" class="geocoder"></div>
        <br>
        <br>
        <br>
        <button id="licensePlateToggle">Show license plate</button>
        <button id="cctvToggle">Show CCTV</button>
        <button id="planeToggle">Show spy plane</button>
        <button id="shotspotterToggle">Show shotspotter</button>
        <button id="stingrayToggle">Show stingray</button>

    </div>
   

    <script>
    // map
             mapboxgl.accessToken = 'pk.eyJ1IjoicnlhbmxpdHRsZSIsImEiOiJjbHhjN3Q3aGwwMDJ0MmpvbzUyMzdoc2lkIn0.esK-vXAPC8mP0teJo9Vn6g';

        const map = new mapboxgl.Map({
            container: 'map',
            style: 'mapbox://styles/ryanlittle/cm3dbxi6o002801pa6nqce30v',
            center: [-76.619, 39.292],
            zoom: 10
        });

    // geocoder
        const geocoder = new MapboxGeocoder({
        accessToken: mapboxgl.accessToken,
        mapboxgl: mapboxgl,
        container: 'geocoder',
        placeholder: 'Search a neighborhood',
    });

    document.getElementById('geocoder').appendChild(geocoder.onAdd(map));


    // load layers


    // license plate
     map.on('load', function () {
    map.addSource('license-plate', {
        type: 'vector',
        url: 'mapbox://ryanlittle.c49km02y'
    });
    
    map.loadImage('assets/license-plate.png', function(error, image) {
        if (error) throw error;
        map.addImage('license-plate', image);
    });
});

     document.getElementById('licensePlateToggle').addEventListener('click', function() {
        const layerId = 'license-plate';

        if (map.getLayer(layerId)) {
            map.removeLayer(layerId);
            map.removeSource('license-plate');
            this.innerText = 'Show license plate';
        } else {
            map.addSource('license-plate', {
                type: 'vector',
                url: 'mapbox://ryanlittle.c49km02y'
            });
            map.addLayer({
                id: layerId,
                type: 'symbol',
                source: 'license-plate',
                'source-layer': 'baltimore-surveillance-data-l-8yykvz',
                layout: {
                    'icon-image': 'license-plate',
                    'icon-size': 0.08,
                    'icon-allow-overlap': true
                }
            });
            this.innerText = 'Hide license plate';
        }
    });


    // CitiWatch_Camera_Locations-6ylw5f
    // ryanlittle.05paul59


    map.on('load', function () {
    // Add the CCTV data source without adding the layer
    map.addSource('cctv', {
        type: 'vector',
        url: 'mapbox://ryanlittle.05paul59'
    });
    
    // Load the CCTV icon image, but do not add the layer yet
    map.loadImage('assets/cctv2.png', function(error, image) {
        if (error) throw error;
        map.addImage('cctv', image);
    });
});

// Toggle button functionality to show/hide the layer
document.getElementById('cctvToggle').addEventListener('click', function() {
    const layerId = 'cctv';

    if (map.getLayer(layerId)) {
        // Remove the layer (but not the source)
        map.removeLayer(layerId);
        this.innerText = 'Show CCTV';
    } else {
        // Add the layer if it doesn't exist
        map.addLayer({
            id: layerId,
            type: 'symbol',
            source: 'cctv',   // Use the existing source
            'source-layer': 'CitiWatch_Camera_Locations-6ylw5f',
            layout: {
                'icon-image': 'cctv',
                'icon-size': 0.08,
                'icon-allow-overlap': true
            }
        });
        this.innerText = 'Hide CCTV';
    }
});


// Spy-Plane-Investigations_data-bdfrq8
// ryanlittle.c0r1pyg9

    map.on('load', function () {
    // Add UHF data source
    map.addSource('plane', {
        type: 'vector',
        url: 'mapbox://ryanlittle.c0r1pyg9'
    });
    
    map.loadImage('assets/plane.png', function(error, image) {
        if (error) throw error;
        map.addImage('plane', image);
    });
});

    document.getElementById('planeToggle').addEventListener('click', function() {
        const layerId = 'plane';

        if (map.getLayer(layerId)) {
            map.removeLayer(layerId);
            this.innerText = 'Show plane';
        } else {
            map.addLayer({
                id: layerId,
                type: 'symbol',
                source: 'plane',
                'source-layer': 'Spy-Plane-Investigations_data-bdfrq8',
                layout: {
                    'icon-image': 'plane',
                    'icon-size': 0.08,
                    'icon-allow-overlap': true
                }
            });
            this.innerText = 'Hide plane';
        }
    });


    map.on('load', function () {
    // Add UHF data source
    map.addSource('shotspotter', {
        type: 'vector',
        url: 'mapbox://ryanlittle.5e9i7e9p'
    });
    
    map.loadImage('assets/shotspotter.png', function(error, image) {
        if (error) throw error;
        map.addImage('shotspotter', image);
    });
});

    document.getElementById('shotspotterToggle').addEventListener('click', function() {
        const layerId = 'shotspotter';

        if (map.getLayer(layerId)) {
            map.removeLayer(layerId);
            this.innerText = 'Show shotspotter';
        } else {
            map.addLayer({
                id: layerId,
                type: 'symbol',
                source: 'shotspotter',
                'source-layer': 'baltimore-surveillance-data_--5tm7wq',
                layout: {
                    'icon-image': 'shotspotter',
                    'icon-size': 0.08,
                    'icon-allow-overlap': true
                }
            });
            this.innerText = 'Hide shotspotter';
        }
    });


    // stingray
    // stingray-7phuk2
    // ryanlittle.9j4nkeey


    map.on('load', function () {
    // Add UHF data source
    map.addSource('stingray', {
        type: 'vector',
        url: 'mapbox://ryanlittle.9j4nkeey'
    });
    
    map.loadImage('assets/stingray.png', function(error, image) {
        if (error) throw error;
        map.addImage('stingray', image);
    });
    });

    document.getElementById('stingrayToggle').addEventListener('click', function() {
        const layerId = 'stingray';

        if (map.getLayer(layerId)) {
            map.removeLayer(layerId);
            this.innerText = 'Show stingray';
        } else {
            map.addLayer({
                id: layerId,
                type: 'symbol',
                source: 'stingray',
                'source-layer': 'stingray-7phuk2',
                layout: {
                    'icon-image': 'stingray',
                    'icon-size': 0.08,
                    'icon-allow-overlap': true
                }
            });
            this.innerText = 'Hide stingray';
        }
    });
 
</script>
</body>
</html>